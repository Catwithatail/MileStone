<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Job Details</title>
    <link rel="stylesheet" href="/css/adminD/sidebar.css" />
    <link rel="stylesheet" href="/css/EmployerD/see_more_detail.css" />
  </head>
  <body>
    <div class="dashboard-wrapper">
      <%- include('../Partials/sidebar', { user: user, activeSection: 'job_listings' }) %>
      <div class="main-content">
        <div class="container">
          <header>
            <div class="logo">Job Details</div>
            <div></div>
          </header>
          <div class="job-header">
            <div class="job-title-section">
              <div class="job-title-info">
                <div class="deadline">Application Deadline: <%= job.deadline %></div>
                <h1 class="job-title"><%= job.title %></h1>
                <div class="company-name"><%= job.company %></div>
                <div class="job-meta">
                  <div class="meta-item">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" class="icon">
                      <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5z"/>
                    </svg>
                    <span><%= job.location %> (<%= job.remote %>)</span>
                  </div>
                  <div class="meta-item">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" class="icon">
                      <path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"/>
                    </svg>
                    <span><%= job.type %></span>
                  </div>
                  <div class="meta-item">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" class="icon">
                      <path d="M11 2h2v5h8v3h-8v5h5v3h-5v4h-2v-4H6v-3h5v-5H3V7h8V2z"/>
                    </svg>
                    <span><%= job.weeklySalary %></span>
                  </div>
                  <div class="meta-item">
                    <svg width="12" height="12" viewBox="0 0 24 22" fill="currentColor" class="icon">
                      <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 16H5V8h14v11z"/>
                    </svg>
                    <span>Posted on <%= job.postedDate %></span>
                  </div>
                </div>
              </div>
              <div class="job-img-container">
                <img src="/assets/company_logo.jpg" alt="xyz company" class="job-img" />
              </div>
            </div>
            <div class="job-actions">
              <button class="edit-button" id="editJobBtn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                  <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                </svg>
                Edit Job
              </button>
              <button class="delete-button">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                  <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V5z"/>
                </svg>
                Delete Job
              </button>
            </div>
          </div>
          <div class="job-description">
            <div class="section-title">
              Job Description
              <div class="section-buttons">
                <button class="edit-button" id="editDescriptionBtn">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                  </svg>
                  Edit
                </button>
              </div>
            </div>
            <div class="description-text">
              <% job.description.split('\n\n').forEach(para => { %>
                <p><%= para %></p><br />
              <% }) %>
              <p><strong>Responsibilities:</strong></p>
              <ul style="margin-left: 20px; margin-top: 10px; margin-bottom: 10px">
                <% job.responsibilities.forEach(resp => { %>
                  <li><%= resp %></li>
                <% }) %>
              </ul>
              <br />
              <p><strong>Requirements:</strong></p>
              <ul style="margin-left: 20px; margin-top: 10px">
                <% job.requirements.forEach(req => { %>
                  <li><%= req %></li>
                <% }) %>
              </ul>
              <div class="skills-required">
                <div class="skills-title">Technical Skills:</div>
                <div class="skills-tags">
                  <% job.skills.forEach(skill => { %>
                    <span class="skill-tag"><%= skill %></span>
                  <% }) %>
                </div>
              </div>
            </div>
          </div>
          <div class="milestones">
            <div class="section-title">
              Project Milestones
              <div class="section-buttons">
                <button class="add-button" id="addMilestoneBtn">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                  </svg>
                  Add Milestone
                </button>
              </div>
            </div>
            <table class="milestones-table">
              <thead>
                <tr>
                  <th style="width: 50%">Deliverable</th>
                  <th style="width: 20%">Deadline</th>
                  <th style="width: 20%">Payment</th>
                  <th style="width: 10%">Actions</th>
                </tr>
              </thead>
              <tbody id="milestones-tbody">
                <% job.milestones.forEach(milestone => { %>
                  <tr>
                    <td><%= milestone.deliverable %></td>
                    <td><%= milestone.deadline %></td>
                    <td class="payment-column"><%= milestone.payment %></td>
                    <td>
                      <div class="milestone-actions">
                        <button class="milestone-button edit-milestone">
                          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                            <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                          </svg>
                        </button>
                        <button class="milestone-button delete-milestone">
                          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                          </svg>
                        </button>
                      </div>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
          <div class="applicants">
            <div class="section-title">Applicants (<%= job.applicants %>)</div>
            <div class="applicants-list">
              <% job.applicantList.forEach(applicant => { %>
                <div class="applicant-item">
                  <div class="applicant-number"><%= applicant.id %></div>
                  <img src="<%= applicant.image %>" alt="Applicant" class="applicant-img" />
                  <div class="applicant-info">
                    <div class="applicant-name"><%= applicant.name %></div>
                    <div class="applicant-title"><%= applicant.title %></div>
                    <div class="applicant-date">Applied on <%= applicant.applied %></div>
                  </div>
                  <a href="/adminD/job_listings/see_more/<%= job.id %>/applicant/<%= applicant.id %>"><button class="view-profile-btn">View Profile</button></a>
                </div>
              <% }) %>
            </div>
          </div>
        </div>
        <div class="modal-overlay" id="editJobModal">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">Edit Job Listing</div>
              <button class="close-modal" id="closeEditJobModal">Ã—</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label class="form-label">Job Title</label>
                <input type="text" class="form-input" id="jobTitleInput" value="<%= job.title %>" />
              </div>
              <div class="form-group">
                <label class="form-label">Company Name</label>
                <input type="text" class="form-input" id="companyNameInput" value="<%= job.company %>" />
              </div>
              <div class="form-group">
                <label class="form-label">Location</label>
                <input type="text" class="form-input" id="locationInput" value="<%= job.location %> (<%= job.remote %>)" />
              </div>
              <div class="form-group">
                <label class="form-label">Job Type</label>
                <select class="form-input" id="jobTypeInput">
                  <option value="Full-time" <%= job.type === 'Full-time' ? 'selected' : '' %>>Full-time</option>
                  <option value="Part-time" <%= job.type === 'Part-time' ? 'selected' : '' %>>Part-time</option>
                  <option value="Contract" <%= job.type === 'Contract' ? 'selected' : '' %>>Contract</option>
                  <option value="Freelance" <%= job.type === 'Freelance' ? 'selected' : '' %>>Freelance</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Salary Range</label>
                <input type="text" class="form-input" id="salaryInput" value="<%= job.weeklySalary %>" />
              </div>
              <div class="form-group">
                <label class="form-label">Application Deadline</label>
                <input type="date" class="form-input" id="deadlineInput" value="<%= job.deadline.split(' ').join('-') %>" />
              </div>
              <div class="warning-text">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="icon">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                </svg>
                Warning: Editing this job listing will result in removal and re-listing of the job. All current applications will be preserved.
              </div>
            </div>
            <div class="modal-footer">
              <button class="cancel-btn" id="cancelEditJob">Cancel</button>
              <button class="save-btn" id="saveEditJob">Save Changes</button>
            </div>
          </div>
        </div>
        <div class="modal-overlay" id="editDescriptionModal">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">Edit Job Description</div>
              <button class="close-modal" id="closeEditDescriptionModal">Ã—</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label class="form-label">Job Description</label>
                <textarea class="form-textarea" id="descriptionTextarea"><%= job.description %>
Responsibilities:
<% job.responsibilities.forEach(resp => { %>- <%= resp %>
<% }) %>
Requirements:
<% job.requirements.forEach(req => { %>- <%= req %>
<% }) %></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">Skills Required (comma-separated)</label>
                <input type="text" class="form-input" id="skillsInput" value="<%= job.skills.join(', ') %>" />
              </div>
            </div>
            <div class="modal-footer">
              <button class="cancel-btn"Â Warrning:Editing this job listing will result in removal and re-listing of the job. All current applications will be preserved.
              </div>
            </div>
            <div class="modal-footer">
              <button class="cancel-btn" id="cancelEditDescription">Cancel</button>
              <button class="save-btn" id="saveEditDescription">Save Changes</button>
            </div>
          </div>
        </div>
        <div class="modal-overlay" id="addMilestoneModal">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">Add New Milestone</div>
              <button class="close-modal" id="closeAddMilestoneModal">Ã—</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label class="form-label">Deliverable Description</label>
                <input type="text" class="form-input" id="deliverableInput" placeholder="E.g., Complete feature X" />
              </div>
              <div class="form-group">
                <label class="form-label">Deadline</label>
                <input type="text" class="form-input" id="milestoneDeadlineInput" placeholder="E.g., Week 2" />
              </div>
              <div class="form-group">
                <label class="form-label">Payment Amount</label>
                <input type="text" class="form-input" id="paymentInput" placeholder="E.g., â‚¹24,900 (20%)" />
              </div>
            </div>
            <div class="modal-footer">
              <button class="cancel-btn" id="cancelAddMilestone">Cancel</button>
              <button class="save-btn" id="saveAddMilestone">Add Milestone</button>
            </div>
          </div>
        </div>
        <div class="modal-overlay" id="editMilestoneModal">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">Edit Milestone</div>
              <button class="close-modal" id="closeEditMilestoneModal">Ã—</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label class="form-label">Deliverable Description</label>
                <input type="text" class="form-input" id="editDeliverableInput" />
              </div>
              <div class="form-group">
                <label class="form-label">Deadline</label>
                <input type="text" class="form-input" id="editMilestoneDeadlineInput" />
              </div>
              <div class="form-group">
                <label class="form-label">Payment Amount</label>
                <input type="text" class="form-input" id="editPaymentInput" />
              </div>
              <input type="hidden" id="editMilestoneIndex" />
            </div>
            <div class="modal-footer">
              <button class="cancel-btn" id="cancelEditMilestone">Cancel</button>
              <button class="save-btn" id="saveEditMilestone">Save Changes</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="/js/EmployerD/see_more_detail.js"></script>
  </body>
</html>